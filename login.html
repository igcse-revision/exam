<html lang="en">
  <head>
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="167327807367-tjcpvsgk84edooodak5tdkdm4ks2b8l4.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
  </head>
  <body>
    <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"></div>
    <script>
      function onSignIn(googleUser) {
        // Useful data for your client-side scripts:
        var profile = googleUser.getBasicProfile();
        console.log("ID: " + profile.getId()); // Don't send this directly to your server!
        console.log('Full Name: ' + profile.getName());
        console.log('Given Name: ' + profile.getGivenName());
        console.log('Family Name: ' + profile.getFamilyName());
        console.log("Image URL: " + profile.getImageUrl());
        console.log("Email: " + profile.getEmail());
        
        alert(profile.getName());

        // The ID token you need to pass to your backend:
        var id_token = googleUser.getAuthResponse().id_token;
        console.log("ID Token: " + id_token);

        
        var url = "https://drive.google.com/thumbnail?authuser=0&sz=w1024&id=16PAVmMBUTKnYh_Cm3Q1s0ThpHHI-WKDM";
//         ajaxGet(url);
        checkPermission();
      }

      function checkPermission() {
          var image = new Image();

          try {
            image.src = "https://drive.google.com/thumbnail?authuser=0&sz=w1024&id=16PAVmMBUTKnYh_Cm3Q1s0ThpHHI-WKDM";
            image.id = "test_id";
          }
          catch(err) {
            alert("Error");
          }


          image.onload = function() {
               alert('Image loaded: ' + this.id);
          };           

          image.onerror = function() {
               alert('Unable to load Image: ' + this.id);
               
             var r = makeXMLHttpRequestAgain(img.src);
              alert(r.status);

          };           

      }

    function ajaxGet(url, data, success, error) {
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState == 4 && xmlhttp.status === 200) {
            if (typeof success === "function") {
                alert("Success");
            }
        }else if(typeof error === "function" && (xmlhttp.status > 299 || xmlhttp.status < 200)){
            alert("Error: "+xmlhttp.status);
        }
    }
    xmlhttp.open("GET", url, true);
//     xmlhttp.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
    xmlhttp.send(JSON.stringify(data));
}

    </script>
  </body>
</html>
